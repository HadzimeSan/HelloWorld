<div class="content-over-media content-over-media--{{ section.settings.video_size }}" style="{% render 'surface', text_color: section.settings.text_color %}">
  {%- assign poster_image = section.settings.poster | default: section.settings.video.preview_image -%}

  {%- capture poster -%}
    {%- unless section.settings.autoplay -%}
      {%- if poster_image != blank -%}
        {{- poster_image | image_url: width: poster_image.width | image_tag: loading: 'lazy', sizes: '100vw', widths: '200,300,400,500,600,700,800,900,1000,1200,1400,1600,1800,2000,2200,2400,2600,2800,3000,3200' -}}
      {%- else -%}
        {{- 'lifestyle-1' | placeholder_svg_tag: 'h-full w-full placeholder' | replace: '<svg', '<svg preserveAspectRatio="xMinYMin slice"' -}}
      {%- endif -%}
    {%- endunless -%}
  {%- endcapture -%}

  {%- if section.settings.video -%}
    <video-media {% if section.settings.autoplay %}autoplay{% endif %} style="--aspect-ratio: {{ section.settings.video.aspect_ratio }}">
      {{- poster -}}
      {{- section.settings.video | video_tag: class: 'object-cover', controls: section.settings.show_controls, playsinline: true, muted: section.settings.autoplay, loop: section.settings.autoplay, preload: 'metadata', image_size: '400x' -}}
    </video-media>
  {%- else -%}
    <video-media host="{{ section.settings.external_video_url.type }}" {% if section.settings.autoplay %}autoplay class="pointer-events-none"{% endif %}>
      {{- poster -}}

      <template>
        {%- if section.settings.external_video_url.type == 'youtube' -%}
          <iframe src="https://www.youtube.com/embed/{{ section.settings.external_video_url.id }}?playsinline=1&{% if section.settings.autoplay %}autoplay=1&controls=0&mute=1&loop=1&{% endif %}enablejsapi=1&rel=0&modestbranding=1&origin={{ 'https://' | append: request.host | url_encode }}" allow="autoplay; encrypted-media" allowfullscreen="allowfullscreen"></iframe>
        {%- elsif section.settings.external_video_url.type == 'vimeo' -%}
          <iframe src="https://player.vimeo.com/video/{{ section.settings.external_video_url.id }}?autopause=1&{% if section.settings.autoplay %}background=1&autoplay=1&loop=1&muted=1&{% endif %}transparent=0&responsive=1&portrait=0&title=0&byline=0&color={{ settings.text_color | remove_first: '#' }}" allow="autoplay; encrypted-media;" allowfullscreen="allowfullscreen"></iframe>
        {%- endif -%}
      </template>
    </video-media>
  {%- endif -%}

  <div class="video-content-container place-self-center text-center" style="width: 100%; max-width: {{ section.settings.content_width }}px; padding: 20px; background: none;">
    <div class="prose" style="background: none; color: {{ section.settings.content_text_color }};">
      {%- if section.settings.show_logo and section.settings.logo != blank -%}
        <div class="logo-container" style="margin-bottom: {{ section.settings.logo_margin_bottom }}px;">
          <img src="{{ section.settings.logo | img_url: '800x' }}" 
               alt="{{ section.settings.logo.alt | escape }}"
               style="max-width: {{ section.settings.logo_width }}px; 
                      width: {{ section.settings.logo_width }}px;
                      height: auto;">
        </div>
      {%- endif -%}
      
      {%- if section.settings.heading != blank -%}
        <h2 class="{{ section.settings.heading_size }}" style="margin-bottom: 15px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">{{ section.settings.heading }}</h2>
      {%- endif -%}

      {%- if section.settings.html_description != blank -%}
        <div class="html-description" style="margin-bottom: 15px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
          {{ section.settings.html_description }}
        </div>
      {%- endif -%}

      {%- if section.settings.text_description != blank -%}
        <div class="text-description" style="margin-bottom: 20px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
          {{ section.settings.text_description }}
        </div>
      {%- endif -%}

      {%- if section.settings.additional_text != blank -%}
        <div class="additional-text" style="margin-bottom: 20px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); font-size: {{ section.settings.additional_text_size }}px;">
          {{ section.settings.additional_text }}
        </div>
      {%- endif -%}

      <div class="buttons-container" style="display: flex; flex-direction: column; gap: 15px; justify-content: center; align-items: center;">
        {%- if section.settings.button_1_text != blank -%}
          <a href="{{ section.settings.button_1_link }}" class="button button-primary" style="
            background: {{ section.settings.button_1_background }};
            color: {{ section.settings.button_1_text_color }};
            padding: {{ section.settings.button_padding_y }}px {{ section.settings.button_padding_x }}px;
            border-radius: {{ section.settings.button_radius }}px;
            display: inline-block;
            text-decoration: none;
            font-size: {{ section.settings.button_font_size }}px;
            font-weight: {{ section.settings.button_font_weight }};
            {% if section.settings.button_1_border_enable %}
              border: {{ section.settings.button_border_width }}px solid {{ section.settings.button_1_border_color }};
            {% endif %}
          ">
            {{ section.settings.button_1_text }}
          </a>
        {%- endif -%}

        {%- if section.settings.button_2_text != blank -%}
          <a href="{{ section.settings.button_2_link }}" class="button button-secondary" style="
            background: {{ section.settings.button_2_background }};
            color: {{ section.settings.button_2_text_color }};
            padding: {{ section.settings.button_padding_y }}px {{ section.settings.button_padding_x }}px;
            border-radius: {{ section.settings.button_radius }}px;
            display: inline-block;
            text-decoration: none;
            font-size: {{ section.settings.button_font_size }}px;
            font-weight: {{ section.settings.button_font_weight }};
            {% if section.settings.button_2_border_enable %}
              border: {{ section.settings.button_border_width }}px solid {{ section.settings.button_2_border_color }};
            {% endif %}
          ">
            {{ section.settings.button_2_text }}
          </a>
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Enhanced Video Banner",
  "class": "shopify-section--video",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "custom.overlay"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Video Settings"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_controls",
      "label": "Show Controls",
      "default": false
    },
    {
      "type": "select",
      "id": "video_size",
      "label": "Video Size",
      "options": [
        {
          "value": "auto",
          "label": "Original Ratio"
        },
        {
          "value": "sm",
          "label": "Small"
        },
        {
          "value": "md",
          "label": "Medium"
        },
        {
          "value": "lg",
          "label": "Large"
        },
        {
          "value": "fill",
          "label": "Full Screen"
        }
      ],
      "default": "fill"
    },
    {
      "type": "video",
      "id": "video",
      "label": "Video File"
    },
    {
      "type": "video_url",
      "id": "external_video_url",
      "accept": ["vimeo", "youtube"],
      "label": "External Video URL",
      "default": "https://www.youtube.com/watch?v=_9VUPq3SxOc"
    },
    {
      "type": "image_picker",
      "id": "poster",
      "label": "Poster Image"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Logo Settings"
    },
    {
      "type": "checkbox",
      "id": "show_logo",
      "label": "Show Logo",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo Image",
      "info": "Recommended size: 400x200px"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 500,
      "step": 10,
      "unit": "px",
      "label": "Logo Width",
      "default": 200
    },
    {
      "type": "range",
      "id": "logo_margin_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Logo Bottom Margin",
      "default": 30
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "range",
      "id": "content_width",
      "min": 400,
      "max": 1200,
      "step": 20,
      "unit": "px",
      "label": "Content Width",
      "default": 800
    },
    {
      "type": "color",
      "id": "content_text_color",
      "label": "Content Text Color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Heading"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading Text",
      "default": "Your Heading Here"
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading Size",
      "options": [
        {
          "value": "h1",
          "label": "H1"
        },
        {
          "value": "h2",
          "label": "H2"
        },
        {
          "value": "h3",
          "label": "H3"
        },
        {
          "value": "h4",
          "label": "H4"
        }
      ],
      "default": "h2"
    },
    {
      "type": "header",
      "content": "Text Content"
    },
    {
      "type": "html",
      "id": "html_description",
      "label": "HTML Description",
      "default": "<p>Custom HTML content goes here</p>"
    },
    {
      "type": "richtext",
      "id": "text_description",
      "label": "Text Description",
      "default": "<p>Text description goes here</p>"
    },
    {
      "type": "richtext",
      "id": "additional_text",
      "label": "Additional Text",
      "default": "<p>More information can go here</p>"
    },
    {
      "type": "range",
      "id": "additional_text_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Additional Text Size",
      "default": 16
    },
    {
      "type": "header",
      "content": "Buttons Settings"
    },
    {
      "type": "range",
      "id": "button_font_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Button Font Size",
      "default": 16
    },
    {
      "type": "select",
      "id": "button_font_weight",
      "label": "Button Font Weight",
      "options": [
        {
          "value": "normal",
          "label": "Normal"
        },
        {
          "value": "bold",
          "label": "Bold"
        },
        {
          "value": "bolder",
          "label": "Bolder"
        },
        {
          "value": "lighter",
          "label": "Lighter"
        },
        {
          "value": "100",
          "label": "100"
        },
        {
          "value": "400",
          "label": "400 (Normal)"
        },
        {
          "value": "700",
          "label": "700 (Bold)"
        },
        {
          "value": "900",
          "label": "900 (Black)"
        }
      ],
      "default": "bold"
    },
    {
      "type": "range",
      "id": "button_padding_x",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Button Horizontal Padding",
      "default": 30
    },
    {
      "type": "range",
      "id": "button_padding_y",
      "min": 5,
      "max": 30,
      "step": 1,
      "unit": "px",
      "label": "Button Vertical Padding",
      "default": 12
    },
    {
      "type": "range",
      "id": "button_radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Button Border Radius",
      "default": 25
    },
    {
      "type": "range",
      "id": "button_border_width",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Button Border Width",
      "default": 0
    },
    {
      "type": "header",
      "content": "Primary Button"
    },
    {
      "type": "text",
      "id": "button_1_text",
      "label": "Button 1 Text",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "button_1_link",
      "label": "Button 1 Link"
    },
    {
      "type": "color",
      "id": "button_1_background",
      "label": "Button 1 Background",
      "default": "#ff0000"
    },
    {
      "type": "color",
      "id": "button_1_text_color",
      "label": "Button 1 Text Color",
      "default": "#ffffff"
    },
    {
      "type": "checkbox",
      "id": "button_1_border_enable",
      "label": "Enable Button 1 Border",
      "default": false
    },
    {
      "type": "color",
      "id": "button_1_border_color",
      "label": "Button 1 Border Color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Secondary Button"
    },
    {
      "type": "text",
      "id": "button_2_text",
      "label": "Button 2 Text",
      "default": "Learn More"
    },
    {
      "type": "url",
      "id": "button_2_link",
      "label": "Button 2 Link"
    },
    {
      "type": "color",
      "id": "button_2_background",
      "label": "Button 2 Background",
      "default": "transparent"
    },
    {
      "type": "color",
      "id": "button_2_text_color",
      "label": "Button 2 Text Color",
      "default": "#ffffff"
    },
    {
      "type": "checkbox",
      "id": "button_2_border_enable",
      "label": "Enable Button 2 Border",
      "default": true
    },
    {
      "type": "color",
      "id": "button_2_border_color",
      "label": "Button 2 Border Color",
      "default": "#ffffff"
    }
  ],
  "presets": [
    {
      "name": "Enhanced Video Banner",
      "settings": {
        "autoplay": true,
        "video_size": "fill",
        "show_logo": true,
        "logo_width": 200,
        "logo_margin_bottom": 30,
        "heading": "Welcome to Our Store",
        "html_description": "<p style='font-size: 1.2em;'>Discover our amazing collection</p>",
        "text_description": "<p>Limited time offer - 20% off all products</p>",
        "additional_text": "<p>Free shipping on all orders</p>",
        "additional_text_size": 16,
        "button_1_text": "Shop Now",
        "button_1_link": "/collections/all",
        "button_1_background": "#ff0000",
        "button_1_text_color": "#ffffff",
        "button_2_text": "Learn More",
        "button_2_link": "/pages/about",
        "button_2_background": "transparent",
        "button_2_text_color": "#ffffff",
        "button_font_size": 16,
        "button_font_weight": "bold",
        "button_padding_x": 30,
        "button_padding_y": 12,
        "button_radius": 25,
        "button_border_width": 1
      }
    }
  ]
}
{% endschema %}